{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "$id": "https://github.com/remind-me-later/Ceres/schemas/trace-metadata.json",
  "title": "Ceres Emulator Trace Metadata",
  "description": "Metadata about a trace collection session from the Ceres Game Boy emulator",
  "type": "object",
  "required": [
    "test_name",
    "entry_count",
    "timestamp",
    "duration_ms",
    "frames_executed",
    "model",
    "buffer_size",
    "truncated",
    "schema_version"
  ],
  "properties": {
    "test_name": {
      "type": "string",
      "description": "Name of the test that generated this trace",
      "examples": ["test_mbc3_tester_cgb", "test_blargg_cpu_instrs", "test_rtc3test_basic"]
    },
    "entry_count": {
      "type": "integer",
      "description": "Total number of trace entries in the trace file",
      "minimum": 0
    },
    "timestamp": {
      "type": "integer",
      "description": "Unix timestamp (seconds) when the trace was collected",
      "minimum": 0
    },
    "duration_ms": {
      "type": "integer",
      "description": "Duration of the test execution in milliseconds",
      "minimum": 0
    },
    "frames_executed": {
      "type": "integer",
      "description": "Number of emulator frames executed during the test",
      "minimum": 0
    },
    "model": {
      "type": "string",
      "description": "Game Boy model used for emulation",
      "enum": ["DMG", "MGB", "CGB", "UNKNOWN"]
    },
    "failure_reason": {
      "type": ["string", "null"],
      "description": "Reason for test failure if test failed, null if test passed",
      "examples": ["Timeout", "Screenshot mismatch", "Serial output mismatch", null]
    },
    "buffer_size": {
      "type": "integer",
      "description": "Maximum size of the trace buffer (number of entries that can be stored)",
      "minimum": 1
    },
    "truncated": {
      "type": "boolean",
      "description": "Whether the trace was truncated (buffer filled before test ended)"
    },
    "schema_version": {
      "type": "string",
      "description": "Version of the trace schema format",
      "pattern": "^\\d+\\.\\d+$",
      "examples": ["1.0", "1.1", "2.0"]
    }
  },
  "examples": [
    {
      "test_name": "test_mbc3_tester_cgb",
      "entry_count": 10000,
      "timestamp": 1762960836,
      "duration_ms": 11017,
      "frames_executed": 300,
      "model": "CGB",
      "failure_reason": "Timeout",
      "buffer_size": 10000,
      "truncated": true,
      "schema_version": "1.0"
    },
    {
      "test_name": "test_blargg_cpu_instrs",
      "entry_count": 5000,
      "timestamp": 1762961000,
      "duration_ms": 5500,
      "frames_executed": 150,
      "model": "CGB",
      "failure_reason": null,
      "buffer_size": 10000,
      "truncated": false,
      "schema_version": "1.0"
    }
  ]
}
